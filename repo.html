<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Veyra-9 — Dossier</title>

<style>
/* ===== Base theme (same tokens as Arc 1) ===== */
:root{
  --bg:#f6f7fb; --ink:#0b0f18; --muted:#3a4150;
  --line:#d7dbea; --panel:#ffffff;
  --brand:#0b3d7a; --brandSoft:#6aa0ff;
  --chip:#eaf1ff; --chipLine:#c9d8ff;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  background:var(--bg); color:var(--ink);
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial;
  -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
}
a{color:var(--brand); text-decoration:none}
a:hover{filter:brightness(1.08); text-decoration:underline}

/* Header / Nav */
.header{
  display:flex; justify-content:space-between; align-items:center;
  padding:14px 18px; background:#eef2ff; border-bottom:1px solid var(--line);
  position:sticky; top:0; z-index:10;
}
.brand{font-weight:800; color:var(--brand)}
nav a{
  display:inline-block; margin-right:10px; padding:6px 10px;
  background:var(--chip); border:1px solid var(--chipLine); border-radius:8px;
  color:var(--brand); font-weight:600;
}
nav a:hover{background:#f4f7ff}
.clock{
  margin-left:8px; background:var(--chip); border:1px solid var(--chipLine);
  color:var(--brand); padding:6px 10px; border-radius:999px; font-weight:700;
}

/* Layout */
.wrap{max-width:1100px; margin:0 auto; padding:20px}
h1{margin:12px 0 14px}
.small{color:var(--muted); font-size:.94rem}

/* ===== Repository UI ===== */
.repo-search{display:flex; gap:12px; align-items:center; margin:12px 0 18px}
.repo-search input{
  padding:10px 12px; border:1px solid var(--line); border-radius:10px; min-width:320px; background:#fff;
}

/* Factions as accordions */
.faction{background:var(--panel); border:1px solid var(--line); border-radius:12px; margin:10px 0; overflow:hidden}
.faction-h{
  display:flex; align-items:center; justify-content:space-between;
  padding:12px 14px; cursor:pointer; font-weight:800; color:var(--brand);
  background:linear-gradient(#f7f9ff,#f1f5ff);
  border-bottom:1px solid var(--line);
}
.faction-h::before{content:"▸"; margin-right:8px; color:var(--brandSoft)}
.faction-h.active::before{content:"▾"}
.badge{font-weight:600; color:var(--brand); background:var(--chip); border:1px solid var(--chipLine); border-radius:999px; padding:2px 8px; font-size:.86rem}
.faction-c{display:none; padding:10px 12px}

/* NPC cards inside each faction */
.npc{border:1px solid var(--line); border-radius:10px; padding:10px 12px; margin:10px 0; background:#fff}
.npc-h{font-weight:800; color:var(--ink); cursor:pointer}
.npc-h small{font-weight:600; color:var(--muted)}
.npc-h::before{content:"＋ "; color:var(--brandSoft)}
.npc-h.active::before{content:"– "}
.npc-c{display:none; margin-top:8px}
.npc-c p{margin:.35rem 0}
</style>

<script>
// -------- live clock (single) --------
function tick(){
  const el = document.getElementById('clock'); if(!el) return;
  el.textContent = new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit',second:'2-digit'}) + ' CEST';
}
setInterval(tick,1000);
window.addEventListener('DOMContentLoaded', tick);

// -------- accordion toggles (single) --------
function wireAccordions(){
  document.querySelectorAll('.faction-h').forEach(h=>{
    h.addEventListener('click', ()=>{
      h.classList.toggle('active');
      const c = h.nextElementSibling; if(c) c.style.display = h.classList.contains('active') ? 'block' : 'none';
    });
  });
  document.querySelectorAll('.npc-h').forEach(h=>{
    h.addEventListener('click', ()=>{
      h.classList.toggle('active');
      const c = h.nextElementSibling; if(c) c.style.display = h.classList.contains('active') ? 'block' : 'none';
    });
  });
}

// -------- search (name/role/faction) --------
function repoSearch(){
  const q = document.getElementById('repoInput').value.trim().toLowerCase();
  const factions = document.querySelectorAll('.faction');
  factions.forEach(f=>{
    // show/hide NPCs
    let any = false;
    f.querySelectorAll('.npc').forEach(n=>{
      const hay = (n.getAttribute('data-hay') || '').toLowerCase();
      const show = !q || hay.includes(q);
      n.style.display = show ? '' : 'none';
      if(show) any = true;
    });
    // show/hide faction block
    f.style.display = any ? '' : 'none';
    // auto-open faction if filtering
    const fh=f.querySelector('.faction-h'), fc=f.querySelector('.faction-c');
    if(q && any){ fh.classList.add('active'); fc.style.display='block'; }
    if(!q){ fh.classList.remove('active'); fc.style.display='none'; f.querySelectorAll('.npc-h').forEach(h=>{ h.classList.remove('active'); }); f.querySelectorAll('.npc-c').forEach(c=>c.style.display='none'); }
  });
}

window.addEventListener('DOMContentLoaded', ()=>{
  wireAccordions();
  repoSearch(); // initial pass (no filter)
});
</script>
</head>

<body>
  <header class="header">
    <div class="brand">VEYRA-9 · Dossier</div>
    <nav>
      <a href="index.html">Arc 1</a>
      <a href="arc2.html">Arc 2</a>
      <a href="repo.html">Dossier</a>
      <span class="clock" id="clock">--:--:--</span>
    </nav>
  </header>

  <main class="wrap">
    <h1>Dossier — Character Repository</h1>

    <div class="repo-search">
      <input id="repoInput" type="search" placeholder="Search by name, role, or faction…" oninput="repoSearch()">
      <span class="small">Type to filter</span>
    </div>

    <!-- ========== Obsidian Accord ========== -->
    <div class="faction">
      <div class="faction-h">Obsidian Accord <span class="badge">handlers, auditors, truth brokers</span></div>
      <div class="faction-c">
        <div class="npc" data-hay="saint accord handler mission control whistleblower leverage ethics truth mare">
          <div class="npc-h">Saint — Accord Handler <small>access without authority</small></div>
          <div class="npc-c">
            <p><b>Appearance & Demeanor.</b> Trim, neutral wardrobe that photographs well; a voice that sounds recorded even live.</p>
            <p><b>Backstory.</b> Rose from field audits after exposing a Helion shell around Noryx quotas. Keeps an unsent message to someone named <i>Mare</i> pinned in a private channel.</p>
            <p><b>Hooks.</b> Exchanges access for proof; will burn a source to save ten.</p>
            <p><b>Progression.</b> Remote in Phase I; appears in II; linchpin or liability in III.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== Helion ========== -->
    <div class="faction">
      <div class="faction-h">Helion Industries <span class="badge">governance & security</span></div>
      <div class="faction-c">
        <div class="npc" data-hay="orus hestrel governor helion optics board politics speech">
          <div class="npc-h">Governor Orus Hestrel — Administrator <small>optics first, stability second</small></div>
          <div class="npc-c">
            <p><b>Appearance & Demeanor.</b> Pressed suits; diction built for press rooms.</p>
            <p><b>Backstory.</b> Former Bryndor liaison; rewarded with Haven after surviving crises on paper.</p>
            <p><b>Hooks.</b> Needs the Quarter quiet before the Board call; trades permits for photo ops.</p>
            <p><b>Progression.</b> Scapegoat, ally, or survivor depending on PCs.</p>
          </div>
        </div>

        <div class="npc" data-hay="lira veyne captain security helion officer line-boss competence">
          <div class="npc-h">Captain Lira Veyne — Security Chief <small>line-holder, principled pragmatist</small></div>
          <div class="npc-c">
            <p><b>Appearance & Demeanor.</b> Uniform crisp even in crisis; braid pinned like an engineering diagram.</p>
            <p><b>Backstory.</b> Dockyard rat turned officer; held a Bryndor line with twelve against fifty.</p>
            <p><b>Hooks.</b> Respects competence; bends rules for civilians; won’t protect lies.</p>
            <p><b>Progression.</b> Patron if earned, rival if undercut, martyr if cornered.</p>
          </div>
        </div>

        <div class="npc" data-hay="meryn ralos risk compliance variance reports liability records">
          <div class="npc-h">Meryn Ralos — Risk Compliance <small>the bureaucracy with a pulse</small></div>
          <div class="npc-c">
            <p><b>Appearance & Demeanor.</b> Tablet, stylus, clean nails; anxiety disguised as policy.</p>
            <p><b>Hooks.</b> Opens records if given cover; fears being the one who signed the wrong line.</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== Zeratek, Reclaimers, Compliance, Malrix, Locals (keep your existing blocks) ========== -->
    <!-- (Paste your remaining factions/NPCs here exactly as you had them; the toggles now work.) -->

    <hr>
    <div class="small">Return to <a href="index.html">Arc 1</a></div>
  </main>
<script>
(function () {
  // --- live clock ---
  function tick(){
    const el = document.getElementById('clock'); if(!el) return;
    el.textContent = new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit',second:'2-digit'}) + ' CEST';
  }
  setInterval(tick, 1000);
  document.addEventListener('DOMContentLoaded', tick);

  // --- event delegation for toggles (works on title OR badge) ---
  document.addEventListener('click', function (e) {
    const fh = e.target.closest('.faction-h');
    if (fh) {
      fh.classList.toggle('active');
      const c = fh.nextElementSibling;
      if (c) c.style.display = fh.classList.contains('active') ? 'block' : 'none';
    }
    const nh = e.target.closest('.npc-h');
    if (nh) {
      nh.classList.toggle('active');
      const c = nh.nextElementSibling;
      if (c) c.style.display = nh.classList.contains('active') ? 'block' : 'none';
    }
  });

  // --- search (kept global for oninput) ---
  window.repoSearch = function(){
    const q = (document.getElementById('repoInput')?.value || '').trim().toLowerCase();
    document.querySelectorAll('.faction').forEach(f=>{
      let any = false;
      f.querySelectorAll('.npc').forEach(n=>{
        const hay = (n.getAttribute('data-hay')||'').toLowerCase();
        const show = !q || hay.includes(q);
        n.style.display = show ? '' : 'none';
        if (show) any = true;
      });
      f.style.display = any ? '' : 'none';

      const fh = f.querySelector('.faction-h');
      const fc = f.querySelector('.faction-c');
      if (fh && fc){
        if (q && any){ fh.classList.add('active'); fc.style.display='block'; }
        if (!q){ fh.classList.remove('active'); fc.style.display='none';
          f.querySelectorAll('.npc-h').forEach(h=>h.classList.remove('active'));
          f.querySelectorAll('.npc-c').forEach(c=>c.style.display='none');
        }
      }
    });
  };
})();
</script>
</body>
</html>